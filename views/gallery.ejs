<script>
    $('#gallery-content').ready(function () {
        (async function () {
            let posters_div = document.getElementById('gallery-content');
            let response = await fetchData('/gallery/data');
            let posters = await response.json();
            posters.forEach(function (poster, index) {
                let columnDiv = document.createElement('div');
                columnDiv.className = 'col';
                let cardDiv = document.createElement('div');
                cardDiv.className = 'card text-center h-300';
                let image = document.createElement('img');
                image.setAttribute('src', poster.image);
                image.className = 'card-img-top';
                let bodyDiv = document.createElement('div');
                let name = document.createElement('h5');
                name.className = 'card-title custom-header';
                name.innerText = poster.name;
                let price = document.createElement('p');
                price.innerText = poster.price + '$';
                price.className = 'custom-btn w-150 mx-auto';
                let color = document.createElement('span');
                color.className = 'dot';
                color.style = 'background-color:' + poster.color;

                bodyDiv.append(name, price, color);
                cardDiv.append(image, bodyDiv);
                columnDiv.appendChild(cardDiv);
                posters_div.appendChild(columnDiv);
            });
        })();
    });
</script>


<div>

    <!-- Portfolio-Section -->
    <section class="gallery-page" id="gallery-content">
        <div class="container">
            <h2>Recently Added Photographs</h2>
            <div class="row justify-content-center">
                <div class="col-md-12 col-12" id="gallery-div" name="gallery-div">

                    <div class="container">
                        <div class="row">
                            <div class="col-sm-8 mt-3">
                                <form class="mt-4"
                                      action="/upload"
                                      method="POST"
                                      enctype="multipart/form-data">
                                    <div class="form-group">
                                        <input
                                                type="file"
                                                name="file"
                                                id="input-files"
                                                class="form-control-file border"/>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Submit</button>
                                </form>
                            </div>
                        </div>
                        <hr />
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="preview-images"></div>
                            </div>
                        </div>
                    </div>
                    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
                    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
                    <script>
                        $(document).ready(function() {
                            let imagesPreview = function(input, placeToInsertImagePreview) {
                                if (input.files) {
                                    let filesAmount = input.files.length;
                                    for (i = 0; i < filesAmount; i++) {
                                        let reader = new FileReader();
                                        reader.onload = function(event) {
                                            $($.parseHTML("<img>"))
                                                .attr("src", event.target.result)
                                                .appendTo(placeToInsertImagePreview);
                                        };
                                        reader.readAsDataURL(input.files[i]);
                                    }
                                }
                            };
                            $("#input-files").on("change", function() {
                                imagesPreview(this, "div.preview-images");
                            });
                        });
                    </script>
                </div>
            </div>
        </div>
    </section>
    <!--/.Portfolio-Section -->


</div>